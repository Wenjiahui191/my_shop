{"version":3,"file":"edit.js","sources":["pages/address/edit.vue","../../../application/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYWRkcmVzcy9lZGl0LnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"container\">\r\n    <view class=\"form-group\">\r\n      <label class=\"form-label\">收货人姓名</label>\r\n      <input v-model=\"form.name\" class=\"form-input\" placeholder=\"请输入收货人姓名\" />\r\n    </view>\r\n\r\n    <view class=\"form-group\">\r\n      <label class=\"form-label\">手机号码</label>\r\n      <input v-model=\"form.phone\" class=\"form-input\" placeholder=\"请输入手机号码\" type=\"tel\" />\r\n    </view>\r\n\r\n    <view class=\"form-group\">\r\n      <label class=\"form-label\">省份</label>\r\n      <picker @change=\"handleProvinceChange\" :value=\"form.province_index\" :range=\"provinces\">\r\n        <view class=\"form-input picker-input\">\r\n          {{ form.province || '请选择省份' }}\r\n        </view>\r\n      </picker>\r\n    </view>\r\n\r\n    <view class=\"form-group\">\r\n      <label class=\"form-label\">城市</label>\r\n      <picker @change=\"handleCityChange\" :value=\"form.city_index\" :range=\"cities\">\r\n        <view class=\"form-input picker-input\">\r\n          {{ form.city || '请选择城市' }}\r\n        </view>\r\n      </picker>\r\n    </view>\r\n\r\n    <view class=\"form-group\">\r\n      <label class=\"form-label\">区/县</label>\r\n      <picker @change=\"handleDistrictChange\" :value=\"form.district_index\" :range=\"districts\">\r\n        <view class=\"form-input picker-input\">\r\n          {{ form.district || '请选择区/县' }}\r\n        </view>\r\n      </picker>\r\n    </view>\r\n\r\n    <view class=\"form-group\">\r\n      <label class=\"form-label\">详细地址</label>\r\n      <input v-model=\"form.detail\" class=\"form-input\" placeholder=\"请输入详细地址\" />\r\n    </view>\r\n\r\n    <view class=\"form-group checkbox-group\">\r\n      <label class=\"checkbox-label\">\r\n        <checkbox :checked=\"form.is_default\" @change=\"form.is_default = $event.detail.value\" />\r\n        <text>设为默认地址</text>\r\n      </label>\r\n    </view>\r\n\r\n    <view class=\"form-actions\">\r\n      <button class=\"cancel-btn\" @click=\"handleCancel\">取消</button>\r\n      <button class=\"submit-btn\" @click=\"handleSubmit\" :disabled=\"loading\">\r\n        {{ loading ? '提交中...' : '确定' }}\r\n      </button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { addAddress, updateAddress, getAddresses } from '../../api/address';\r\n\r\n// 简化的地址数据\r\nconst PROVINCES = ['北京市', '天津市', '河北省', '山西省', '内蒙古自治区', '辽宁省', '吉林省', '黑龙江省', '上海市', '江苏省', '浙江省', '安徽省', '福建省', '江西省', '山东省', '河南省', '湖北省', '湖南省', '广东省', '广西壮族自治区', '海南省', '重庆市', '四川省', '贵州省', '云南省', '西藏自治区', '陕西省', '甘肃省', '青海省', '宁夏回族自治区', '新疆维吾尔自治区'];\r\n\r\nconst CITIES = {\r\n  '北京市': ['东城区', '西城区', '朝阳区', '丰台区', '石景山区', '海淀区', '门头沟区', '房山区', '通州区', '顺义区', '昌平区', '大兴区', '怀柔区', '平谷区', '密云县', '延庆县'],\r\n  '上海市': ['黄浦区', '徐汇区', '长宁区', '静安区', '普陀区', '虹口区', '杨浦区', '闵行区', '宝山区', '浦东新区', '金山区', '松江区', '青浦区', '奉贤区', '崇明县'],\r\n  '广东省': ['广州市', '深圳市', '珠海市', '汕头市', '佛山市', '韶关市', '河源市', '梅州市', '惠州市', '汕尾市', '东莞市', '中山市', '阳江市', '清远市', '潮州市', '揭阳市', '云浮市'],\r\n  '其他': ['其他']\r\n};\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      form: {\r\n        id: null,\r\n        name: '',\r\n        phone: '',\r\n        province: '',\r\n        province_index: 0,\r\n        city: '',\r\n        city_index: 0,\r\n        district: '',\r\n        district_index: 0,\r\n        detail: '',\r\n        is_default: false\r\n      },\r\n      provinces: PROVINCES,\r\n      cities: ['请选择'],\r\n      districts: ['请选择'],\r\n      loading: false,\r\n      isEdit: false\r\n    };\r\n  },\r\n  onLoad(options) {\r\n    if (options.id) {\r\n      this.form.id = options.id;\r\n      this.isEdit = true;\r\n      this.loadAddressDetail(options.id);\r\n    }\r\n  },\r\n  methods: {\r\n    async loadAddressDetail(id) {\r\n      try {\r\n        const addresses = await getAddresses();\r\n        const address = addresses.find(a => a.id === parseInt(id));\r\n        if (address) {\r\n          this.form = {\r\n            id: address.id,\r\n            name: address.name,\r\n            phone: address.phone,\r\n            province: address.province,\r\n            province_index: this.provinces.indexOf(address.province),\r\n            city: address.city,\r\n            city_index: 0,\r\n            district: address.district,\r\n            district_index: 0,\r\n            detail: address.detail,\r\n            is_default: address.is_default\r\n          };\r\n          this.handleProvinceChange({ detail: { value: this.form.province_index } });\r\n        }\r\n      } catch (error) {\r\n        uni.showToast({\r\n          title: '加载地址失败',\r\n          icon: 'none'\r\n        });\r\n      }\r\n    },\r\n    handleProvinceChange(e) {\r\n      const index = e.detail?.value || e;\r\n      this.form.province = this.provinces[index];\r\n      this.form.province_index = index;\r\n      \r\n      const provinceCities = CITIES[this.form.province] || ['其他'];\r\n      this.cities = provinceCities;\r\n      this.form.city = provinceCities[0];\r\n      this.form.city_index = 0;\r\n      this.form.district = '';\r\n      this.form.district_index = 0;\r\n      this.districts = ['请选择'];\r\n    },\r\n    handleCityChange(e) {\r\n      const index = e.detail?.value || e;\r\n      this.form.city = this.cities[index];\r\n      this.form.city_index = index;\r\n      this.form.district = '';\r\n      this.form.district_index = 0;\r\n      this.districts = ['请选择'];\r\n    },\r\n    handleDistrictChange(e) {\r\n      const index = e.detail?.value || e;\r\n      this.form.district = this.districts[index];\r\n      this.form.district_index = index;\r\n    },\r\n    async handleSubmit() {\r\n      if (!this.form.name) {\r\n        uni.showToast({ title: '请输入收货人姓名', icon: 'none' });\r\n        return;\r\n      }\r\n      if (!this.form.phone) {\r\n        uni.showToast({ title: '请输入手机号码', icon: 'none' });\r\n        return;\r\n      }\r\n      if (!this.form.province) {\r\n        uni.showToast({ title: '请选择省份', icon: 'none' });\r\n        return;\r\n      }\r\n      if (!this.form.city) {\r\n        uni.showToast({ title: '请选择城市', icon: 'none' });\r\n        return;\r\n      }\r\n      if (!this.form.detail) {\r\n        uni.showToast({ title: '请输入详细地址', icon: 'none' });\r\n        return;\r\n      }\r\n\r\n      this.loading = true;\r\n      try {\r\n        const data = {\r\n          name: this.form.name,\r\n          phone: this.form.phone,\r\n          province: this.form.province,\r\n          city: this.form.city,\r\n          district: this.form.district || '其他',\r\n          detail: this.form.detail,\r\n          is_default: this.form.is_default\r\n        };\r\n\r\n        if (this.isEdit) {\r\n          await updateAddress(this.form.id, data);\r\n          uni.showToast({ title: '更新成功', icon: 'success' });\r\n        } else {\r\n          await addAddress(data);\r\n          uni.showToast({ title: '添加成功', icon: 'success' });\r\n        }\r\n\r\n        setTimeout(() => {\r\n          uni.navigateBack({ delta: 1 });\r\n        }, 500);\r\n      } catch (error) {\r\n        uni.showToast({\r\n          title: this.isEdit ? '更新失败' : '添加失败',\r\n          icon: 'none'\r\n        });\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    handleCancel() {\r\n      uni.navigateBack({ delta: 1 });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n  min-height: 100vh;\r\n  background-color: #f8f8f8;\r\n  padding: 15px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 15px;\r\n  background-color: #fff;\r\n  padding: 15px;\r\n  border-radius: 6px;\r\n}\r\n\r\n.form-label {\r\n  display: block;\r\n  font-size: 14px;\r\n  color: #333;\r\n  margin-bottom: 8px;\r\n  font-weight: bold;\r\n}\r\n\r\n.form-input {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.picker-input {\r\n  background-color: #fff;\r\n  color: #999;\r\n}\r\n\r\n.checkbox-group {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.checkbox-label {\r\n  display: flex;\r\n  align-items: center;\r\n  font-size: 14px;\r\n  color: #333;\r\n}\r\n\r\n.checkbox-label checkbox {\r\n  margin-right: 8px;\r\n}\r\n\r\n.form-actions {\r\n  display: flex;\r\n  gap: 10px;\r\n  margin-top: 30px;\r\n}\r\n\r\n.cancel-btn,\r\n.submit-btn {\r\n  flex: 1;\r\n  padding: 15px;\r\n  border: none;\r\n  border-radius: 6px;\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n}\r\n\r\n.cancel-btn {\r\n  background-color: #f0f0f0;\r\n  color: #333;\r\n}\r\n\r\n.submit-btn {\r\n  background-color: #3cc51f;\r\n  color: #fff;\r\n}\r\n\r\n.submit-btn:disabled {\r\n  background-color: #ccc;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/projects/my_shop/shop_app/pages/address/edit.vue'\nwx.createPage(MiniProgramPage)"],"names":["getAddresses","uni","updateAddress","addAddress"],"mappings":"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"}
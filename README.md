# å•†åŸç³»ç»Ÿé¡¹ç›®

ä¸€ä¸ªå®Œæ•´çš„ç”µå•†è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«ç”¨æˆ·å°ç¨‹åºã€ç®¡ç†åå°å’ŒæœåŠ¡ç«¯ APIã€‚

## ğŸ“‹ é¡¹ç›®ç»“æ„

```
my_shop/
â”œâ”€â”€ shop_app/           # ç”¨æˆ·ç«¯å°ç¨‹åºåº”ç”¨ï¼ˆUniAppï¼‰
â”œâ”€â”€ shop_backend/       # ç®¡ç†åå°ç³»ç»Ÿï¼ˆVue 3 + Viteï¼‰
â”œâ”€â”€ shop_node/          # æœåŠ¡ç«¯ APIï¼ˆNode.js/Expressï¼‰
â””â”€â”€ README.md           # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯ - ç”¨æˆ·å°ç¨‹åº (shop_app)
- **æ¡†æ¶**: UniAppï¼ˆVue 2 + uni-appï¼‰
- **ç‰¹æ€§**: ä¸€æ¬¡å¼€å‘ï¼Œå¤šç«¯éƒ¨ç½²
- **ä¸»è¦åŠŸèƒ½**: å•†å“æµè§ˆã€è´­ç‰©è½¦ã€è®¢å•ç®¡ç†ã€åœ°å€ç®¡ç†ç­‰

### ç®¡ç†åå° (shop_backend)
- **æ¡†æ¶**: Vue 3 + Vite
- **UIåº“**: Element Plus
- **çŠ¶æ€ç®¡ç†**: Pinia
- **HTTP**: Axios
- **ä¸»è¦åŠŸèƒ½**: å•†å“ç®¡ç†ã€åˆ†ç±»ç®¡ç†ã€è®¢å•ç®¡ç†ã€ç”¨æˆ·ç®¡ç†

### åç«¯æœåŠ¡ (shop_node)
- **è¿è¡Œæ—¶**: Node.js
- **æ¡†æ¶**: Express.js
- **æ•°æ®åº“**: MySQL
- **ç¼“å­˜**: Redis
- **è®¤è¯**: JWT
- **æ–‡æ¡£**: Swagger/OpenAPI
- **æ–‡ä»¶ä¸Šä¼ **: Multer

## ğŸ“¦ æ ¸å¿ƒåŠŸèƒ½

### ç”¨æˆ·ä¾§åŠŸèƒ½ï¼ˆå°ç¨‹åºï¼‰
- âœ… **å•†å“æµè§ˆ**: æŒ‰åˆ†ç±»æµè§ˆå•†å“ï¼Œæœç´¢åŠŸèƒ½
- âœ… **è´­ç‰©è½¦**: æ·»åŠ /åˆ é™¤å•†å“ï¼Œä¿®æ”¹æ•°é‡
- âœ… **è®¢å•ç®¡ç†**: åˆ›å»ºè®¢å•ã€æŸ¥çœ‹è®¢å•ã€è®¢å•è¯¦æƒ…
- âœ… **åœ°å€ç®¡ç†**: æ·»åŠ /ç¼–è¾‘/åˆ é™¤æ”¶è´§åœ°å€ï¼Œè®¾ç½®é»˜è®¤åœ°å€
- âœ… **ç”¨æˆ·è´¦æˆ·**: æ³¨å†Œã€ç™»å½•ã€ä¸ªäººèµ„æ–™ã€é€€å‡ºç™»å½•
- âœ… **æ”¶è—å•†å“**: æ·»åŠ /åˆ é™¤æ”¶è—ï¼ŒæŸ¥çœ‹æ”¶è—åˆ—è¡¨

### ç®¡ç†å‘˜åŠŸèƒ½ï¼ˆåå°ï¼‰
- âœ… **å•†å“ç®¡ç†**: CRUDã€çŠ¶æ€ç®¡ç†ã€å›¾ç‰‡ä¸Šä¼ 
- âœ… **åˆ†ç±»ç®¡ç†**: æ ‘å½¢åˆ†ç±»ã€æ”¯æŒå¤šçº§
- âœ… **è®¢å•ç®¡ç†**: è®¢å•æŸ¥è¯¢ã€çŠ¶æ€ç®¡ç†ã€å‘è´§ç®¡ç†
- âœ… **ç”¨æˆ·ç®¡ç†**: ç”¨æˆ·åˆ—è¡¨ã€ç”¨æˆ·è¯¦æƒ…
- âœ… **æ•°æ®ç»Ÿè®¡**: ä»ªè¡¨ç›˜ã€å›¾è¡¨ç»Ÿè®¡

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 14
- MySQL >= 5.7
- Redisï¼ˆå¯é€‰ï¼‰
- npm æˆ– yarn

### åç«¯æœåŠ¡ (shop_node)

#### 1. å®‰è£…ä¾èµ–
```bash
cd shop_node
npm install
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡
å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶é…ç½®æ•°æ®åº“ä¿¡æ¯ï¼š
```env
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=shop_db
JWT_SECRET=your_jwt_secret
REDIS_HOST=localhost
REDIS_PORT=6379
```

#### 3. åˆå§‹åŒ–æ•°æ®åº“
```bash
# è¿è¡Œåˆå§‹åŒ–è„šæœ¬
npm run init-db
```

#### 4. å¯åŠ¨æœåŠ¡
```bash
# å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
npm run dev

# ç”Ÿäº§æ¨¡å¼
npm start
```

æœåŠ¡è¿è¡Œåœ¨ `http://localhost:8088`

### ç®¡ç†åå° (shop_backend)

#### 1. å®‰è£…ä¾èµ–
```bash
cd shop_backend
npm install
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡
åˆ›å»º `.env.local` æ–‡ä»¶ï¼š
```env
VITE_API_BASE_URL=http://localhost:8088
```

#### 3. å¯åŠ¨å¼€å‘æœåŠ¡
```bash
npm run dev
```

è®¿é—® `http://localhost:5173` æ‰“å¼€ç®¡ç†ç³»ç»Ÿ

### ç”¨æˆ·å°ç¨‹åº (shop_app)

#### 1. å®‰è£…ä¾èµ–
```bash
cd shop_app
npm install
```

#### 2. é…ç½® API åœ°å€
ç¼–è¾‘ `utils/request.js`ï¼Œä¿®æ”¹ `BASE_URL`ï¼š
```javascript
const BASE_URL = 'http://localhost:8088';
```

#### 3. å¯åŠ¨å¼€å‘æœåŠ¡
```bash
npm run dev
```

ä½¿ç”¨ HBuilderX æˆ–å…¶ä»– UniApp IDE æ‰“å¼€é¡¹ç›®å¼€å‘

## ğŸ” è®¤è¯æœºåˆ¶

### JWT è®¤è¯æµç¨‹
1. **ç”¨æˆ·æ³¨å†Œ**: `/api/auth/register` - åˆ›å»ºæ–°è´¦æˆ·
2. **ç”¨æˆ·ç™»å½•**: `/api/auth/login` - è·å– JWT Token
3. **è¯·æ±‚éªŒè¯**: åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ `Authorization: Bearer <token>`
4. **Token æœ‰æ•ˆæœŸ**: 24å°æ—¶ï¼ˆå¯é…ç½®ï¼‰

### ç®¡ç†å‘˜è®¤è¯
- ä¸“ç”¨ç™»å½•ç«¯ç‚¹: `/api/admin/auth/login`
- ä¸­é—´ä»¶: `adminAuthMiddleware.js` - éªŒè¯ç®¡ç†å‘˜èº«ä»½
- æƒé™æ§åˆ¶: ç®¡ç†å‘˜ç‰¹å®šæ¥å£éœ€è¦ admin è§’è‰²

## ğŸ“ API æ–‡æ¡£

### æ–‡æ¡£è®¿é—®
å¯åŠ¨åç«¯æœåŠ¡åï¼Œè®¿é—® Swagger æ–‡æ¡£ï¼š
```
http://localhost:8088/api-docs
```

### ä¸»è¦ API ç«¯ç‚¹

#### è®¤è¯ç›¸å…³
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `GET /api/auth/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- `POST /api/admin/auth/login` - ç®¡ç†å‘˜ç™»å½•

#### å•†å“ç›¸å…³
- `GET /api/products/categories` - è·å–åˆ†ç±»æ ‘
- `GET /api/products` - è·å–å•†å“åˆ—è¡¨
- `GET /api/products/:id` - è·å–å•†å“è¯¦æƒ…
- `POST /api/admin/products` - åˆ›å»ºå•†å“ï¼ˆéœ€ç™»å½•ï¼‰
- `PUT /api/admin/products/:id` - æ›´æ–°å•†å“
- `DELETE /api/admin/products/:id` - åˆ é™¤å•†å“

#### è´­ç‰©è½¦ç›¸å…³
- `POST /api/cart` - æ·»åŠ åˆ°è´­ç‰©è½¦
- `GET /api/cart` - è·å–è´­ç‰©è½¦
- `PUT /api/cart/:id` - ä¿®æ”¹è´­ç‰©è½¦é¡¹
- `DELETE /api/cart/:id` - åˆ é™¤è´­ç‰©è½¦é¡¹

#### è®¢å•ç›¸å…³
- `POST /api/orders` - åˆ›å»ºè®¢å•
- `GET /api/orders` - è·å–è®¢å•åˆ—è¡¨
- `GET /api/orders/:id` - è·å–è®¢å•è¯¦æƒ…
- `PATCH /api/orders/:id/cancel` - å–æ¶ˆè®¢å•

#### åœ°å€ç›¸å…³
- `POST /api/address` - æ·»åŠ åœ°å€
- `GET /api/address` - è·å–åœ°å€åˆ—è¡¨
- `PUT /api/address/:id` - æ›´æ–°åœ°å€
- `DELETE /api/address/:id` - åˆ é™¤åœ°å€

#### æ–‡ä»¶ä¸Šä¼ 
- `POST /api/upload/file` - ä¸Šä¼ å•ä¸ªæ–‡ä»¶
- `POST /api/upload/product-image` - ä¸Šä¼ å•†å“å›¾ç‰‡
- `POST /api/upload/product-images` - ä¸Šä¼ å¤šä¸ªå•†å“å›¾ç‰‡

## ğŸ“Š æ•°æ®åº“ç»“æ„

### æ ¸å¿ƒè¡¨

#### usersï¼ˆç”¨æˆ·è¡¨ï¼‰
```sql
- id: ç”¨æˆ·ID
- username: ç”¨æˆ·å
- password: å¯†ç ï¼ˆåŠ å¯†ï¼‰
- email: é‚®ç®±
- phone: æ‰‹æœºå·
- nickname: æ˜µç§°
- avatar: å¤´åƒURL
- role: è§’è‰²ï¼ˆuser/adminï¼‰
- created_at: åˆ›å»ºæ—¶é—´
```

#### productsï¼ˆå•†å“è¡¨ï¼‰
```sql
- id: å•†å“ID
- category_id: åˆ†ç±»ID
- name: å•†å“åç§°
- description: å•†å“æè¿°
- price: ä»·æ ¼
- stock: åº“å­˜
- image_url: å›¾ç‰‡URL
- status: çŠ¶æ€ï¼ˆon_shelf/off_shelfï¼‰
- created_at: åˆ›å»ºæ—¶é—´
```

#### categoriesï¼ˆåˆ†ç±»è¡¨ï¼‰
```sql
- id: åˆ†ç±»ID
- name: åˆ†ç±»åç§°
- parent_id: çˆ¶åˆ†ç±»IDï¼ˆæ”¯æŒå¤šçº§ï¼‰
- sort_order: æ’åº
- created_at: åˆ›å»ºæ—¶é—´
```

#### ordersï¼ˆè®¢å•è¡¨ï¼‰
```sql
- id: è®¢å•ID
- user_id: ç”¨æˆ·ID
- total_price: æ€»ä»·
- status: è®¢å•çŠ¶æ€
- address: æ”¶è´§åœ°å€
- created_at: åˆ›å»ºæ—¶é—´
```

## ğŸ› ï¸ å¸¸è§å¼€å‘ä»»åŠ¡

### æ·»åŠ æ–°çš„ API ç«¯ç‚¹

1. **åˆ›å»º Controller**ï¼ˆshop_node/src/controllers/ï¼‰
2. **åˆ›å»º Route**ï¼ˆshop_node/src/routes/ï¼‰
3. **æ·»åŠ  Swagger æ³¨é‡Š**
4. **åœ¨ app.js ä¸­æ³¨å†Œè·¯ç”±**
5. **å‰ç«¯åˆ›å»º API è°ƒç”¨æ¨¡å—**ï¼ˆapi/ ç›®å½•ï¼‰

### ä¿®æ”¹æ•°æ®åº“ç»“æ„

1. ä¿®æ”¹ `shop_node/src/database/schema.sql`
2. è¿è¡Œåˆå§‹åŒ–è„šæœ¬é‡æ–°åˆ›å»ºè¡¨
3. æ›´æ–°ç›¸å…³ Controller

### å‰ç«¯æ ·å¼è°ƒæ•´

- **å°ç¨‹åº**: ä¿®æ”¹ `.vue` æ–‡ä»¶ä¸­çš„ `<style scoped>` éƒ¨åˆ†
- **ç®¡ç†åå°**: ä½¿ç”¨ Element Plus ç»„ä»¶å’Œè‡ªå®šä¹‰ CSS

## ğŸ”„ ç»Ÿä¸€å“åº”æ ¼å¼

æ‰€æœ‰ API å“åº”éµå¾ªç»Ÿä¸€æ ¼å¼ï¼š

### æˆåŠŸå“åº”
```json
{
  "code": 200,
  "message": "æˆåŠŸ",
  "data": {...},
  "pagination": {
    "page": 1,
    "limit": 10,
    "total": 100,
    "pages": 10
  }
}
```

### é”™è¯¯å“åº”
```json
{
  "code": 400,
  "message": "é”™è¯¯ä¿¡æ¯"
}
```

## ğŸ“± å°ç¨‹åºé…ç½®

### pages.json é…ç½®
```json
{
  "pages": [...],
  "tabBar": {
    "list": [
      {"pagePath": "pages/index/index", "text": "é¦–é¡µ"},
      {"pagePath": "pages/category/category", "text": "åˆ†ç±»"},
      {"pagePath": "pages/cart/cart", "text": "è´­ç‰©è½¦"},
      {"pagePath": "pages/user/user", "text": "æˆ‘çš„"}
    ]
  }
}
```

### ç™»å½•çŠ¶æ€ç®¡ç†
- æœªç™»å½•: æ˜¾ç¤ºé¦–é¡µã€åˆ†ç±»ã€æˆ‘çš„ï¼ˆæ— è´­ç‰©è½¦ï¼‰
- å·²ç™»å½•: æ˜¾ç¤ºæ‰€æœ‰ tabï¼ŒåŒ…æ‹¬è´­ç‰©è½¦

## ğŸ§ª æµ‹è¯•è´¦æˆ·

### é»˜è®¤ç”¨æˆ·
- ç”¨æˆ·å: `testuser`
- å¯†ç : `password123`

### é»˜è®¤ç®¡ç†å‘˜
- ç”¨æˆ·å: `admin`
- å¯†ç : `admin123`

> é¦–æ¬¡è¿è¡Œæ—¶éœ€åœ¨åˆå§‹åŒ–æ•°æ®åº“è„šæœ¬ä¸­åˆ›å»º

## ğŸ“¦ ä¾èµ–ç®¡ç†

### åç«¯ä¸»è¦ä¾èµ–
- express: Web æ¡†æ¶
- mysql2: MySQL é©±åŠ¨
- jsonwebtoken: JWT è®¤è¯
- bcryptjs: å¯†ç åŠ å¯†
- multer: æ–‡ä»¶ä¸Šä¼ 
- swagger-jsdoc: API æ–‡æ¡£

### å‰ç«¯ä¸»è¦ä¾èµ–
- vue: æ¡†æ¶
- element-plus: UI åº“
- axios: HTTP å®¢æˆ·ç«¯
- pinia: çŠ¶æ€ç®¡ç†

## ğŸš¨ å¸¸è§é—®é¢˜

### æ•°æ®åº“è¿æ¥å¤±è´¥
- æ£€æŸ¥ MySQL æœåŠ¡æ˜¯å¦è¿è¡Œ
- éªŒè¯ .env æ–‡ä»¶ä¸­çš„æ•°æ®åº“é…ç½®
- ç¡®è®¤ç”¨æˆ·æœ‰è®¿é—®æƒé™

### ç«¯å£è¢«å ç”¨
- ä¿®æ”¹ .env ä¸­çš„ PORT é…ç½®
- æˆ–ä½¿ç”¨ `lsof -i :3000` æŸ¥æ‰¾å ç”¨è¿›ç¨‹

### CORS é”™è¯¯
- åç«¯å·²é…ç½® CORSï¼Œæ£€æŸ¥å‰ç«¯è¯·æ±‚åœ°å€æ˜¯å¦æ­£ç¡®
- ç¡®ä¿ API_BASE_URL é…ç½®æ— è¯¯

### Token è¿‡æœŸ
- é‡æ–°ç™»å½•è·å–æ–° Token
- Token æœ‰æ•ˆæœŸåœ¨åç«¯é…ç½®ä¸­è®¾ç½®

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issue æˆ– PRã€‚

## ğŸ“„ è®¸å¯è¯

MIT License

---

**æœ€åæ›´æ–°**: 2025å¹´12æœˆ17æ—¥
